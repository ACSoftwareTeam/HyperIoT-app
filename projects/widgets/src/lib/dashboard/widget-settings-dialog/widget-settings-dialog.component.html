<div id="widget-settings-dialog" class="dialog d-flex flex-column align-self-center hyt-modal-body"
    [ngSwitch]="dialogDataState">

    <div *ngSwitchCase="0">
        <header i18n="@@HYT_widget_settings_title">Widget Settings</header>
        <div class="loader"></div>
    </div>

    <div id="container-settings-content" *ngSwitchCase="1">
        <header i18n="@@HYT_widget_settings_title">Widget Settings</header>

        <div *ngIf="autoUpdateConfigStatus === 'SUCCESS'" class="auto-update-config-warn" i18n="@@HYT_auto_update_config_warn">
            Attention! An automatic update has been applied to the widget configuration to make it compatible with the latest updates. It is necessary to save the configuration to make the change effective.
        </div>
        <div *ngIf="autoUpdateConfigStatus === 'ERROR'" class="auto-update-config-error" i18n="@@HYT_auto_update_config_error">
            Error! Unable to update the widget configuration automatically. The widget may not work correctly after the latest updates. It is recommended to delete the widget and set up a new one.
        </div>

        <form class="content flex-grow-1" #settingsForm="ngForm">

            <div class="common-settings d-flex flex-row">

                <!-- <div class="d-flex flex-row"> -->
                    <div class="mt-4 mx-2 d-flex flex-column align-items-stretch flex-basis-dialog">
                        <hyt-input-template name="name" id="name" type="text"
                            i18n-placeholder="@@HYT_name" placeholder="Name"
                            [(ngModel)]="widgetName" #name="ngModel" [isRequired]="true" required
                            pattern="[A-Za-z0-9 -\.]*"></hyt-input-template>
                    </div>

                    <div class="mt-4 mx-2 d-flex flex-column align-items-stretch flex-basis-dialog">
                        <hyt-input-template type="text" disabled [isDisabled]="true"
                            i18n-placeholder="@@HYT_type" placeholder="Type"
                            fieldValue="{{widget.type}}"></hyt-input-template>
                    </div>
                <!-- </div> -->

            </div>

            <div class="custom-settings" [ngSwitch]="widget.type">
                <div *ngSwitchCase="'sensor-value'">
                    <hyperiot-sensor-value-settings [widget]="widget" [areaId]="areaId" [modalApply]="modalApply.asObservable()"
                        [settingsForm]="settingsForm">
                    </hyperiot-sensor-value-settings>
                </div>
                <div *ngSwitchCase="'offline-table'">
                    <hyperiot-time-chart-settings [widget]="widget" [areaId]="areaId" [modalApply]="modalApply.asObservable()"
                        [settingsForm]="settingsForm">
                    </hyperiot-time-chart-settings>
                </div>
                <div class="container-widget-type" *ngSwitchCase="'realtime-table'">
                    <hyperiot-time-chart-settings [widget]="widget" [areaId]="areaId" [modalApply]="modalApply.asObservable()"
                        [settingsForm]="settingsForm">
                    </hyperiot-time-chart-settings>
                </div>
                <div *ngSwitchCase="'gauge'">
                    <hyperiot-sensor-value-settings [widget]="widget" [areaId]="areaId" [modalApply]="modalApply.asObservable()"
                        [settingsForm]="settingsForm">
                    </hyperiot-sensor-value-settings>
                </div>
                <div *ngSwitchCase="'histogram'">
                    <hyperiot-time-chart-settings [widget]="widget" [areaId]="areaId" [modalApply]="modalApply.asObservable()"
                        [settingsForm]="settingsForm">
                    </hyperiot-time-chart-settings>
                </div>
                <div *ngSwitchCase="'time-chart'">
                    <hyperiot-time-chart-settings [widget]="widget" [areaId]="areaId" [modalApply]="modalApply.asObservable()"
                        [settingsForm]="settingsForm">
                    </hyperiot-time-chart-settings>
                </div>
                <div *ngSwitchCase="'bodymap'">
                  <hyperiot-bodymap-settings [widget]="widget" [areaId]="areaId" [modalApply]="modalApply.asObservable()"
                                           [settingsForm]="settingsForm"></hyperiot-bodymap-settings>
                </div>
                <div *ngSwitchCase="'ecg'">
                  <hyperiot-ecg-settings [widget]="widget" [areaId]="areaId" [modalApply]="modalApply.asObservable()"
                                                [settingsForm]="settingsForm">
                  </hyperiot-ecg-settings>
                </div>
                <div *ngSwitchCase="'defibrillator'">
                    <hyperiot-defibrillator-settings [widget]="widget" [areaId]="areaId" [modalApply]="modalApply.asObservable()"
                                                  [settingsForm]="settingsForm">
                    </hyperiot-defibrillator-settings>
                  </div>
                <div *ngSwitchCase="'algorithm-offline-table'">
                    <hyperiot-algorithm-settings [widget]="widget" [modalApply]="modalApply.asObservable()"
                        [settingsForm]="settingsForm">
                    </hyperiot-algorithm-settings>
                </div>
                <div *ngSwitchDefault></div>
            </div>

        </form>

        <footer class="d-flex flex-row align-items-center justify-content-end">
            <hyt-button class="button-confirm" [color]="'hyt-base-default-white'" (clickFn)="confirm()" [isDisabled]="settingsForm.invalid">
                <mat-icon>check</mat-icon>
                <span i18n="@@HYT_apply">Apply</span>
            </hyt-button>
            <hyt-button class="button-close" [color]="'hyt-base-default-white'" (clickFn)="closeModal($event)">
                <mat-icon>close</mat-icon>
                <span i18n="@@HYT_cancel">Cancel</span>
            </hyt-button>
        </footer>

    </div>

    <div *ngSwitchCase="-1">
        <header i18n="@@HYT_widget_settings_title">Widget Settings</header>
        <div class="mt-5 d-flex flex-column align-items-center justify-content-center">
            <h2 i18n="@@HYT_error_occurred_long">An error has occurred, contact the administrator!</h2>
        </div>
    </div>

</div>
