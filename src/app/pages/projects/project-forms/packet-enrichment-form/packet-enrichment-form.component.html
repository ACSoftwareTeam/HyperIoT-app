<div id="container-enrichment-form" class="container">

  <!-- <p class="subtitle-section">
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer rutrum magna lacus, a lacinia orci feugiat non. Quisque pharetra quam vitae pharetra euismod. Curabitur sodales eget elit id aliquam. In hac habitasse platea dictumst. Nam in dignissim leo. Pellentesque in lorem at justo mollis volutpat. Nam rutrum, orci vel fermentum semper, felis ante dictum nisl, vitae ultricies lectus ante iaculis nibh. Donec facilisis sagittis ligula, ut consequat elit facilisis non. Nam non enim magna. Mauris euismod velit sit amet porta fermentum.
    </p> ONLY FOR PROJECT DETAIL -->

  <div *ngIf="showCover && !editMode" class="row">

    <div id="container-add-enrich" class="col-12">

      <hyt-button 
        [color] = "'hyt-base-default-white'"
        (clickFn)="loadEmpty()"
      >
        <span class="hyt-icon icon-hyt_plus"></span>
        Add enrichment
      </hyt-button>

    </div>

  </div> <!-- END FIRST ROW -->

  <form [ngClass]="{ hidden: !editMode, 'blurred': loadingStatus !== LoadingStatus.Ready }" class="enrichment-form" [formGroup]="form" autocomplete="on">
    
    <div class="form-group row">
      
      <div 
        id="ffield-col-enrich-name" 
        class="col-tag-cat col-6"
      ><!-- col-4 -->

        <hyt-input-text 
          [form]="form" formControlName="rule-name" name="rule-name" [isRequired]="true"
          i18n-placeholder="@@HYT_name" placeholder="HYT_name" [injectedErrorMsg]="getError('rule-name')"
          i18n-hintMessage="@@HYT_hint_rule_name"
          hintMessage="HYT_hint_rule_name"
        >
        </hyt-input-text>

      </div>
      
      <div 
        id="ffield-col-enrich-rules" 
        class="col-tag-cat col-6"
      > <!-- col-4 -->

        <hyt-select 
          [form]="form" [options]="enrichmentRules" (changeFn)="enrichmentTypeChanged($event)"
          formControlName="rule-type" name="rule-type" [isRequired]="true" i18n-label="@@HYT_rule_type"
          label="HYT_rule_type">
        </hyt-select>
        
      </div>

      <div 
        *ngIf="enrichmentType=='AddTagRuleAction' || enrichmentType=='AddCategoryRuleAction'"
        id="ffield-col-enrich-tag-cat" 
        class="col-8 offset-2 col-tag-cat" 
      >

        <hyt-asset-tag 
          #assetTag
          *ngIf="enrichmentType=='AddTagRuleAction'" 
          [project]="project" 
          [packet]="packet"
          [selectedTags]="assetTags">
        </hyt-asset-tag>

        <hyt-asset-category
          #assetCategory
          *ngIf="enrichmentType=='AddCategoryRuleAction'" 
          [project]="project" 
          [packet]="packet"
          [selectedCategories]="assetCategories">
        </hyt-asset-category>
        
      </div>

    </div> <!-- END FIRST FORM ROW -->

    <div class="form-group row">

      <div class="col-12">

        <hyt-text-area 
          [form]="form" formControlName="rule-description" name="rule-description"
          i18n-placeholder="@@HYT_description" placeholder="HYT_description"
          i18n-hintMessage="@@HYT_hint_rule_description"
          hintMessage="HYT_hint_rule_description">
        </hyt-text-area>

      </div>

    </div> <!-- END SECOND FORM ROW -->

    <div class="form-group row">

      <div class="col-12">

        <hyt-rule-definition 
          #ruleDef [currentPacket]="packet"  [ruleType]="'enrichment'" [projectId]="project.id"
        >
        </hyt-rule-definition>

      </div>

    </div> <!-- END THIRD FORM ROW -->

    <!-- 
      TODO: This HTML block is repeated
      across all 'entity' components,
      consider making a component out of it 
    -->

    <div *ngIf="loadingStatus !== LoadingStatus.Ready" class="overlay d-flex flex-column align-items-center justify-content-center">

      <div 
        *ngIf="loadingStatus === LoadingStatus.Loading" 
      >

          <h4 i18n="@@HYT_loading_data">HYT_loading_data</h4>

      </div> 
      
      <div *ngIf="loadingStatus === LoadingStatus.Error" class="error-overlay d-flex flex-column justify-content-center">
          <h4 i18n="@@HYT_error_occurred">HYT_error_occurred</h4>

          <hyt-button 
              [color]="'hyt-base-default-white'" 
              (click)="loadingStatus = LoadingStatus.Ready"
          >
              <span i18n="@@HYT_close">HYT_close</span> <span class="icon-hyt_cancelC"></span> 
          </hyt-button>
      </div> 

      <h4 *ngIf="loadingStatus === LoadingStatus.Saving" i18n="@@HYT_saving_data">HYT_saving_data</h4>

      <mat-progress-bar 
          *ngIf="loadingStatus === LoadingStatus.Loading || loadingStatus === LoadingStatus.Saving"
          mode="indeterminate"
      ></mat-progress-bar> 

    </div>

  </form> <!-- END FORM -->

</div> <!-- END GENERAL CONTAINER -->

